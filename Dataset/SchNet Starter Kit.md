# SchNet Starter Kit Notebook 数据集分析总结

## 一、数据集概况

https://www.kaggle.com/code/toshik/schnet-starter-kit/notebook

该 Notebook 利用的是与分子 / 材料性质预测相关的数据集，主要用于机器学习 / 深度学习模型来预测分子的物理或化学属性。核心任务是基于分子结构预测 **原子对之间的标量耦合常数**。

数据文件包括：

| 数据表 / 文件 | 功能 / 内容 | 用途 |
|---|---|---|
| **structures.csv** | 提供分子中每个原子的三维坐标 (x, y, z) 和原子类型 | 构建分子几何结构，作为模型输入 |
| **train.csv** | 训练样本：原子对及其标量耦合常数 | 监督学习目标 |
| **test.csv** | 测试样本（仅含输入特征，不含目标值） | 模型预测阶段 |
| **scalar_coupling_contributions.csv** | 每对原子耦合常数的物理机制分解（如 Fermi contact, spin-dipolar 等） | 特征工程或误差分析 |

---

## 二、数据结构与特征

- **节点特征（原子级）**：原子类型（元素、原子序数）
- **几何坐标**：原子在三维空间的位置
- **原子对 / 边特征**：两个原子之间的距离、空间关系
- **目标值**：标量耦合常数 `scalar_coupling_constant`
- **贡献项分解**：不同物理机制对耦合常数的贡献

---

## 三、任务目标

- 给定分子结构与原子对索引 (atom_index_0, atom_index_1)  
- 预测该对原子间的 **标量耦合常数**  
- 这是一个 **回归任务**，输出为连续值  

---

## 四、建模流程

1. **加载数据**：读取 `structures.csv`、`train.csv` 等文件  
2. **数据预处理**：合并结构与原子对表，构建分子图  
3. **特征工程**：  
   - 计算原子对距离  
   - 构建图（原子为节点，边为邻接关系）  
   - 节点 / 边特征标准化  
4. **模型定义**：SchNet 或类似的图神经网络  
   - 原子嵌入 (embedding)  
   - 交互层 (interaction blocks)  
   - readout 层输出预测值  
5. **训练**：  
   - 损失函数：MSE  
   - 优化器：Adam  
   - 监控验证集性能  
6. **评估与预测**：  
   - 在 `test.csv` 上预测  
   - 绘制预测 vs 真实值散点图  
   - 统计误差指标（MAE, RMSE）  
7. **可视化与分析**：  
   - 训练 / 验证损失曲线  
   - 不同耦合类型与距离区间的误差分析  

---

## 五、优点、挑战与局限

### 优点
- 提供端到端的分子属性预测流程
- 强调几何信息与物理机制分解，任务有物理意义
- 可作为 GNN 分子建模的入门案例

### 挑战
- 数据规模大，训练计算开销高
- 特征设计对性能影响大
- 需要注意过拟合与泛化问题
- 模型未必天然满足物理规律

---