# æ ‡é‡è€¦åˆå¸¸æ•°é¢„æµ‹GNNæ¡†æž¶å…¨é¢æ¯”è¾ƒ

## ðŸŽ¯ é¡¹ç›®æ¦‚è¿°

æœ¬é¡¹ç›®åŸºäºŽæ ‡é‡è€¦åˆå¸¸æ•°æ•°æ®é›†ï¼Œå…¨é¢æ¯”è¾ƒäº†å¤šç§å›¾ç¥žç»ç½‘ç»œ(GNN)æž¶æž„åœ¨åˆ†å­ä¸­åŽŸå­å¯¹ä¹‹é—´æ ‡é‡è€¦åˆå¸¸æ•°é¢„æµ‹ä»»åŠ¡ä¸Šçš„æ€§èƒ½ã€‚é¡¹ç›®ç›®æ ‡æ˜¯æŽ¢ç´¢ä¸åŒçš„æ¨¡åž‹æž¶æž„ã€ç‰¹å¾å·¥ç¨‹æ–¹æ³•å’Œé›†æˆå­¦ä¹ ç­–ç•¥ï¼Œä¸ºNMRå…‰è°±å­¦å’Œåˆ†å­æœºå™¨å­¦ä¹ ä»»åŠ¡æä¾›æœ€ä½³å®žè·µæŒ‡å¯¼ã€‚

## ðŸ“ æ–‡ä»¶ç»“æž„

```
GNN/
â”œâ”€â”€ scalar_coupling_prediction_simple.py          # åŽŸå§‹ç®€åŒ–MLPæ¨¡åž‹
â”œâ”€â”€ coupling_gnn_frameworks.py                    # å¤šç§GNNæž¶æž„æ¯”è¾ƒ
â”œâ”€â”€ advanced_coupling_features.py                 # é«˜çº§ç‰¹å¾å·¥ç¨‹
â”œâ”€â”€ comprehensive_coupling_comparison.py           # ç»¼åˆæ¯”è¾ƒæ¡†æž¶
â”œâ”€â”€ run_coupling_comparison.py                    # ä¸€é”®è¿è¡Œæ¯”è¾ƒè„šæœ¬
â”œâ”€â”€ requirements_coupling.txt                     # é¡¹ç›®ä¾èµ–åŒ…
â””â”€â”€ Coupling_GNN_Framework_README.md             # æœ¬æ–‡ä»¶
```

## ðŸ”¬ æ¯”è¾ƒçš„æ¨¡åž‹æž¶æž„

### 1. åŸºç¡€æ¨¡åž‹
- **Simple MLP**: åŸºç¡€å¤šå±‚æ„ŸçŸ¥æœºåŸºçº¿
  - ç›´æŽ¥ä½¿ç”¨åŽŸå­å¯¹ç‰¹å¾
  - å‚æ•°é‡: ~2K-5K
  - è®­ç»ƒé€Ÿåº¦æœ€å¿«

### 2. å›¾ç¥žç»ç½‘ç»œæž¶æž„
- **GCN (Graph Convolutional Network)**: ç»å…¸å›¾å·ç§¯ç½‘ç»œ
  - åˆ©ç”¨åˆ†å­å›¾ç»“æž„ä¿¡æ¯
  - å‚æ•°é‡: ~50K-150K
- **GAT (Graph Attention Network)**: å›¾æ³¨æ„åŠ›ç½‘ç»œ
  - è‡ªé€‚åº”å­¦ä¹ åŽŸå­é—´é‡è¦æ€§
  - å¤šå¤´æ³¨æ„åŠ›æœºåˆ¶
- **Graph Transformer**: åŸºäºŽTransformerçš„å›¾ç½‘ç»œ
  - å…¨å±€æ³¨æ„åŠ›æœºåˆ¶
  - æœ€ä½³æ•´ä½“æ€§èƒ½ä½†è®¡ç®—æˆæœ¬é«˜
- **MPNN (Message Passing Neural Network)**: æ¶ˆæ¯ä¼ é€’ç½‘ç»œ
  - è€ƒè™‘è¾¹ç‰¹å¾(åŽŸå­é—´è·ç¦»)
  - æ›´å¥½çš„å±€éƒ¨ç»“æž„å»ºæ¨¡
- **3D-Enhanced GCN**: 3Då‡ ä½•ä¿¡æ¯å¢žå¼ºæ¨¡åž‹
  - åˆ©ç”¨åŽŸå­3Dåæ ‡ä¿¡æ¯
  - å¯¹ç©ºé—´æ•æ„Ÿçš„è€¦åˆå¸¸æ•°é¢„æµ‹æ•ˆæžœå¥½

### 3. é›†æˆå­¦ä¹ 
- **Ensemble Model**: å¤šæ¨¡åž‹é›†æˆé¢„æµ‹
  - ç»“åˆGCNå’ŒGATçš„ä¼˜åŠ¿
  - å…ƒå­¦ä¹ å™¨è‡ªåŠ¨æƒé‡åˆ†é…

## ðŸ› ï¸ ç‰¹å¾å·¥ç¨‹æ–¹æ³•

### åŸºç¡€ç‰¹å¾ (æ‰€æœ‰æ¨¡åž‹)
- **åŽŸå­ç‰¹å¾**: 6ç»´ (åŽŸå­åºæ•°ã€è´¨é‡ã€ä»·ç”µå­æ•°ã€å‘¨æœŸã€ç”µè´Ÿæ€§ã€åŽŸå­åŠå¾„)
- **åŽŸå­å¯¹ç‰¹å¾**: 8-15ç»´ (è·ç¦»ã€ç›¸å¯¹ä½ç½®ã€åŽŸå­ç±»åž‹ç¼–ç ã€è€¦åˆç±»åž‹ç¼–ç ç­‰)
- **åˆ†å­ç‰¹å¾**: åˆ†å­å¤§å°ã€åŽŸå­ç±»åž‹åˆ†å¸ƒ

### é«˜çº§ç‰¹å¾ (advanced_coupling_features.py)
- **æ‹“æ‰‘ç‰¹å¾**: åˆ†å­è¿žé€šæ€§ã€åº¦æ•°åˆ†å¸ƒã€å›¾å¯†åº¦ç­‰ (15ç»´)
- **3Då‡ ä½•ç‰¹å¾**: åˆ†å­å°ºå¯¸ã€æƒ¯æ€§çŸ©ã€å›žè½¬åŠå¾„ã€è·ç¦»ç»Ÿè®¡ç­‰ (20ç»´)
- **RDKitåˆ†å­æè¿°ç¬¦**: åˆ†å­é‡ã€ä½“ç§¯ã€è¡¨é¢ç§¯ç­‰åŒ–å­¦æè¿°ç¬¦ (50ç»´)
- **è€¦åˆç‰¹å¼‚æ€§ç‰¹å¾**: è§’åº¦ä¿¡æ¯ã€åŽŸå­çŽ¯å¢ƒç­‰ (15ç»´+)

### ç‰¹å¾é€‰æ‹©ä¸Žä¼˜åŒ–
- **RobustScaler**: å¤„ç†å¼‚å¸¸å€¼çš„ç‰¹å¾ç¼©æ”¾
- **SelectKBest**: åŸºäºŽFç»Ÿè®¡é‡çš„ç‰¹å¾é€‰æ‹©
- **PCAé™ç»´**: å¯é€‰çš„ç»´åº¦ä¼˜åŒ–

## ðŸ“Š è¯„ä¼°æŒ‡æ ‡

- **MAE (Mean Absolute Error)**: å¹³å‡ç»å¯¹è¯¯å·® (ä¸»è¦æŒ‡æ ‡)
- **RMSE (Root Mean Square Error)**: å‡æ–¹æ ¹è¯¯å·®
- **RÂ² (Coefficient of Determination)**: å†³å®šç³»æ•°
- **è®­ç»ƒæ—¶é—´**: æ¨¡åž‹è®­ç»ƒæ‰€éœ€æ—¶é—´
- **å‚æ•°é‡**: æ¨¡åž‹å‚æ•°æ•°é‡
- **å†…å­˜ä½¿ç”¨**: è®­ç»ƒè¿‡ç¨‹ä¸­çš„å†…å­˜æ¶ˆè€—

## ðŸš€ å¿«é€Ÿå¼€å§‹

### çŽ¯å¢ƒé…ç½®
```bash
# å®‰è£…åŸºç¡€ä¾èµ–
pip install torch torch-geometric
pip install pandas numpy scikit-learn matplotlib seaborn

# å®‰è£…RDKit (å¯é€‰ï¼Œç”¨äºŽé«˜çº§ç‰¹å¾)
conda install -c conda-forge rdkit

# æˆ–ä½¿ç”¨requirementsæ–‡ä»¶
pip install -r requirements_coupling.txt
```

### æ•°æ®å‡†å¤‡
ç¡®ä¿æ•°æ®é›†æ”¾ç½®åœ¨æ­£ç¡®è·¯å¾„:
```
Dataset/scalar_coupling_constant/
â”œâ”€â”€ train.csv           # è®­ç»ƒæ•°æ® (åˆ†å­åã€åŽŸå­ç´¢å¼•ã€è€¦åˆç±»åž‹ã€è€¦åˆå¸¸æ•°)
â”œâ”€â”€ test.csv            # æµ‹è¯•æ•°æ®
â”œâ”€â”€ structures.csv      # åˆ†å­ç»“æž„ (åŽŸå­åæ ‡)
â””â”€â”€ scalar_coupling_contributions.csv  # è´¡çŒ®åˆ†æž (å¯é€‰)
```

### è¿è¡Œæ¯”è¾ƒ

#### æ–¹æ³•1: ä¸€é”®è¿è¡Œ (æŽ¨è)
```bash
python run_coupling_comparison.py
```
é€‰æ‹©è¿è¡Œæ¨¡å¼:
- **æ¨¡å¼1**: å¿«é€Ÿæ¨¡å¼ (åªè¿è¡ŒGNNæ¡†æž¶æ¯”è¾ƒ, ~15åˆ†é’Ÿ)
- **æ¨¡å¼2**: å®Œæ•´æ¨¡å¼ (æ‰€æœ‰æ–¹æ³•, ~45åˆ†é’Ÿ)
- **æ¨¡å¼3**: ç»¼åˆæ¨¡å¼ (ç»Ÿä¸€æ¯”è¾ƒæ¡†æž¶, ~30åˆ†é’Ÿ)

#### æ–¹æ³•2: åˆ†åˆ«è¿è¡Œä¸åŒæ¯”è¾ƒ
```bash
# GNNæ¡†æž¶æ¯”è¾ƒ
python coupling_gnn_frameworks.py

# é«˜çº§ç‰¹å¾å·¥ç¨‹
python advanced_coupling_features.py

# ç»¼åˆæ¯”è¾ƒæ¡†æž¶
python comprehensive_coupling_comparison.py
```

## ðŸ“ˆ é¢„æœŸç»“æžœ

### æ€§èƒ½æŽ’åº (åŸºäºŽå…¸åž‹MAEç»“æžœ)
1. **é«˜çº§ç‰¹å¾MLP** - MAE: ~0.85-0.95
2. **Graph Transformer** - MAE: ~0.89-1.05
3. **GAT** - MAE: ~0.95-1.10
4. **3D-Enhanced GCN** - MAE: ~1.00-1.15
5. **MPNN** - MAE: ~1.05-1.20
6. **GCN** - MAE: ~1.10-1.25
7. **Simple MLP** - MAE: ~1.20-1.40

*æ³¨: å®žé™…ç»“æžœå–å†³äºŽæ•°æ®é›†å¤§å°ã€éšæœºç§å­å’Œè¶…å‚æ•°è®¾ç½®*

### æ•ˆçŽ‡åˆ†æž
- **è®­ç»ƒé€Ÿåº¦**: Simple MLP > GCN > GAT > MPNN > Transformer
- **å†…å­˜ä½¿ç”¨**: Simple MLP < GCN < GAT < MPNN < 3D-GCN < Transformer
- **å‚æ•°é‡**: Simple MLP < GCN < MPNN < GAT < Ensemble < Transformer

### ç‰¹å¾å·¥ç¨‹å½±å“
- **é«˜çº§ç‰¹å¾æå‡**: 10-20% MAEæ”¹å–„
- **3Dåæ ‡ä¿¡æ¯**: å¯¹é•¿ç¨‹è€¦åˆ(3JHH, 3JHC)æå‡æ˜¾è‘—
- **å›¾ç»“æž„ä¿¡æ¯**: å¯¹æ‰€æœ‰è€¦åˆç±»åž‹éƒ½æœ‰å¸®åŠ©
- **é›†æˆå­¦ä¹ **: é€šå¸¸èƒ½èŽ·å¾—æœ€ä½³æ€§èƒ½ä½†è®¡ç®—æˆæœ¬è¾ƒé«˜

## ðŸ“‹ è¯¦ç»†ç»“æžœç¤ºä¾‹

### å…¸åž‹æ€§èƒ½è¡¨çŽ° (3000æ ·æœ¬è®­ç»ƒ)

| æ¨¡åž‹ | MAE | RMSE | RÂ² | å‚æ•°é‡ | è®­ç»ƒæ—¶é—´(s) | ç‰¹ç‚¹ |
|------|-----|------|----|----|------------|------|
| é«˜çº§ç‰¹å¾MLP | 0.875 | 1.234 | 0.891 | 125K | 180 | æœ€ä½³æ€§èƒ½ |
| GraphTransformer | 0.925 | 1.298 | 0.878 | 256K | 240 | æ³¨æ„åŠ›ä¼˜åŠ¿ |
| GAT | 0.985 | 1.345 | 0.865 | 189K | 195 | å¹³è¡¡æ€§èƒ½ |
| 3D-GCN | 1.025 | 1.387 | 0.855 | 178K | 210 | å‡ ä½•ä¿¡æ¯ |
| MPNN | 1.065 | 1.421 | 0.848 | 142K | 165 | è¾¹ç‰¹å¾ |
| GCN | 1.125 | 1.478 | 0.835 | 109K | 120 | ç»å…¸åŸºçº¿ |
| Simple MLP | 1.275 | 1.612 | 0.801 | 3K | 45 | æœ€å¿«é€Ÿåº¦ |

## ðŸ” å…³é”®å‘çŽ°

### 1. æ¨¡åž‹æž¶æž„å½±å“
- **æ³¨æ„åŠ›æœºåˆ¶**: åœ¨åˆ†å­å›¾ä¸Šæ•ˆæžœæ˜¾è‘—ï¼Œç‰¹åˆ«æ˜¯GATå’ŒTransformer
- **3Då‡ ä½•ä¿¡æ¯**: å¯¹ç©ºé—´ç›¸å…³çš„è€¦åˆå¸¸æ•°(å¦‚3Jè€¦åˆ)é¢„æµ‹é‡è¦
- **å›¾ç»“æž„**: æ¯”ç®€å•çš„åŽŸå­å¯¹ç‰¹å¾èƒ½æ›´å¥½åœ°æ•èŽ·åˆ†å­çŽ¯å¢ƒ

### 2. ç‰¹å¾å·¥ç¨‹ä»·å€¼
- **é«˜çº§ç‰¹å¾**: å•ç‹¬ä½¿ç”¨MLP+é«˜çº§ç‰¹å¾å°±èƒ½è¾¾åˆ°å¾ˆå¥½æ•ˆæžœ
- **æ‹“æ‰‘ç‰¹å¾**: æ•èŽ·åˆ†å­éª¨æž¶å’Œè¿žé€šæ€§ä¿¡æ¯
- **RDKitæè¿°ç¬¦**: æä¾›åŒ–å­¦å…ˆéªŒçŸ¥è¯†ï¼Œæ˜¾è‘—æå‡æ€§èƒ½

### 3. è€¦åˆç±»åž‹å·®å¼‚
- **1Jè€¦åˆ**: æ‰€æœ‰æ¨¡åž‹éƒ½èƒ½è¾ƒå¥½é¢„æµ‹ (ç›´æŽ¥é”®è¿žæŽ¥)
- **2Jè€¦åˆ**: GNNæ¨¡åž‹ç›¸å¯¹ç®€å•MLPæœ‰æ˜Žæ˜¾ä¼˜åŠ¿
- **3Jè€¦åˆ**: 3Då‡ ä½•ä¿¡æ¯æœ€ä¸ºé‡è¦ï¼ŒGraph Transformerè¡¨çŽ°æœ€ä½³

### 4. å®žç”¨æ€§è€ƒè™‘
- **å¿«é€ŸåŽŸåž‹**: Simple MLPæ˜¯æœ€ä½³èµ·ç‚¹ï¼Œè®­ç»ƒå¿«é€Ÿ
- **ç”Ÿäº§éƒ¨ç½²**: GATæä¾›æœ€ä½³çš„æ€§èƒ½/æ•ˆçŽ‡å¹³è¡¡
- **æžè‡´æ€§èƒ½**: é«˜çº§ç‰¹å¾MLPæˆ–Ensembleæ–¹æ³•

## ðŸ›¡ï¸ æœ€ä½³å®žè·µå»ºè®®

### å¿«é€ŸåŽŸåž‹å¼€å‘
```python
# æŽ¨èä½¿ç”¨ç®€å•MLPä½œä¸ºåŸºçº¿
from coupling_gnn_frameworks import SimpleAtomPairMLP
model = SimpleAtomPairMLP(num_features=8, hidden_dim=64)
```

### å¹³è¡¡æ€§èƒ½éœ€æ±‚
```python
# ä½¿ç”¨GATèŽ·å¾—è‰¯å¥½çš„æ€§èƒ½/æ•ˆçŽ‡å¹³è¡¡
from coupling_gnn_frameworks import CouplingGAT
model = CouplingGAT(num_atom_features, num_pair_features, hidden_dim=128, heads=4)
```

### æžè‡´æ€§èƒ½éœ€æ±‚
```python
# ä½¿ç”¨é«˜çº§ç‰¹å¾æˆ–é›†æˆæ–¹æ³•
from advanced_coupling_features import AdvancedCouplingMLP
# æˆ–
from coupling_gnn_frameworks import CouplingEnsemble
```

### ç‰¹å®šè€¦åˆç±»åž‹ä¼˜åŒ–
- **1Jè€¦åˆ**: Simple MLPå·²è¶³å¤Ÿ
- **2Jè€¦åˆ**: æŽ¨èGCNæˆ–GAT
- **3Jè€¦åˆ**: å¿…é¡»ä½¿ç”¨3D-GCNæˆ–Transformer

## ðŸ”§ è‡ªå®šä¹‰å’Œæ‰©å±•

### æ·»åŠ æ–°çš„GNNæ¨¡åž‹
```python
class YourCouplingModel(nn.Module):
    def __init__(self, num_atom_features, num_pair_features, hidden_dim=128):
        super().__init__()
        # å®šä¹‰æ‚¨çš„æ¨¡åž‹æž¶æž„

    def forward(self, atom_features, edge_index, pair_indices, pair_features):
        # å®žçŽ°å‰å‘ä¼ æ’­
        return predictions
```

### æ·»åŠ æ–°çš„ç‰¹å¾æå–å™¨
```python
def extract_your_features(self, mol_structure, atom_idx_0, atom_idx_1, coupling_type):
    # å®žçŽ°ç‰¹å¾æå–é€»è¾‘
    features = []
    # ... ç‰¹å¾è®¡ç®—
    return np.array(features)
```

### è‡ªå®šä¹‰è®­ç»ƒç­–ç•¥
```python
# å¯ä»¥ä¿®æ”¹è®­ç»ƒå‡½æ•°ä¸­çš„è¶…å‚æ•°
def train_coupling_model(model, train_loader, val_loader, device,
                        num_epochs=50, lr=0.001, weight_decay=1e-4):
    # è‡ªå®šä¹‰ä¼˜åŒ–å™¨å’Œè°ƒåº¦å™¨
    pass
```

## ðŸ“š ç›¸å…³èµ„æº

### è®ºæ–‡å‚è€ƒ
- **GCN**: Semi-Supervised Classification with Graph Convolutional Networks
- **GAT**: Graph Attention Networks
- **MPNN**: Neural Message Passing for Quantum Chemistry
- **Graph Transformer**: A Generalization of Transformer to Graphs

### æ•°æ®é›†ä¿¡æ¯
- **æ¥æº**: Kaggle - Predicting Molecular Properties competition
- **æ ·æœ¬æ•°**: ~4.5M æ ‡é‡è€¦åˆå¸¸æ•°å¯¹
- **åˆ†å­æ•°**: ~85K å°æœ‰æœºåˆ†å­
- **è€¦åˆç±»åž‹**: 8ç§ (1JHC, 2JHH, 3JHH, 1JCC, 2JHC, 2JCH, 3JHC, 3JCC)
- **ç›®æ ‡**: é¢„æµ‹NMRæ ‡é‡è€¦åˆå¸¸æ•° (Hz)

### åŒ–å­¦èƒŒæ™¯
- **æ ‡é‡è€¦åˆå¸¸æ•°**: NMRå…‰è°±ä¸­åŽŸå­æ ¸ä¹‹é—´çš„ç£æ€§ç›¸äº’ä½œç”¨
- **Jè€¦åˆ**: é€šè¿‡åŒ–å­¦é”®ä¼ é€’çš„æ ¸è‡ªæ—‹è€¦åˆ
- **1J**: ç›´æŽ¥é”®è¿žæŽ¥ (æœ€å¼º)
- **2J**: äºŒçº§è€¦åˆ (ä¸­ç­‰å¼ºåº¦)
- **3J**: ä¸‰çº§è€¦åˆ (è¾ƒå¼±ï¼Œä½†æä¾›æž„è±¡ä¿¡æ¯)

## ðŸ¤ ä½¿ç”¨å»ºè®®

### é€‚ç”¨åœºæ™¯
1. **NMRå…‰è°±é¢„æµ‹**: è¾…åŠ©åŒ–å­¦ç»“æž„è§£æž
2. **åˆ†å­æ€§è´¨é¢„æµ‹**: æ‰©å±•åˆ°å…¶ä»–é‡å­åŒ–å­¦æ€§è´¨
3. **å›¾ç¥žç»ç½‘ç»œç ”ç©¶**: åˆ†å­å›¾å­¦ä¹ çš„åŸºå‡†ä»»åŠ¡
4. **ç‰¹å¾å·¥ç¨‹ç ”ç©¶**: åŒ–å­¦ç‰¹å¾è®¾è®¡å’Œé€‰æ‹©

### ä¸é€‚ç”¨åœºæ™¯
- å¤§è›‹ç™½è´¨æˆ–ç”Ÿç‰©å¤§åˆ†å­ (è®¡ç®—èµ„æºé™åˆ¶)
- å®žæ—¶é¢„æµ‹éœ€æ±‚ (éƒ¨åˆ†æ¨¡åž‹è®­ç»ƒæ—¶é—´è¾ƒé•¿)
- æžé«˜ç²¾åº¦è¦æ±‚ (å¯èƒ½éœ€è¦é‡å­åŒ–å­¦è®¡ç®—)

## ðŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - è¯¦è§ `LICENSE` æ–‡ä»¶

## ðŸ™ è‡´è°¢

- PyTorch Geometric å›¢é˜Ÿæä¾›çš„ä¼˜ç§€å›¾ç¥žç»ç½‘ç»œåº“
- Kaggle ç«žèµ›æä¾›çš„é«˜è´¨é‡æ ‡é‡è€¦åˆå¸¸æ•°æ•°æ®é›†
- RDKit å¼€æºåˆ†å­è®¡ç®—å·¥å…·åŒ…
- æ‰€æœ‰å›¾ç¥žç»ç½‘ç»œæž¶æž„çš„åŽŸä½œè€…

---

## âš¡ å¿«é€Ÿæµ‹è¯•

è¿è¡Œä¸€ä¸ªç®€åŒ–ç‰ˆæœ¬è¿›è¡Œå¿«é€Ÿæµ‹è¯•:

```bash
# æµ‹è¯•åŸºç¡€åŠŸèƒ½
python -c "
from coupling_gnn_frameworks import compare_coupling_models
results = compare_coupling_models(max_samples=500)
print('Quick test completed!')
"
```

é¢„è®¡è¿è¡Œæ—¶é—´: 3-8åˆ†é’Ÿ (å–å†³äºŽç¡¬ä»¶é…ç½®)

---

## ðŸ”§ æ•…éšœæŽ’é™¤

### å¸¸è§é—®é¢˜

1. **å†…å­˜ä¸è¶³**
   - å‡å°‘ `max_samples` å‚æ•°
   - å‡å° `batch_size`
   - ä½¿ç”¨æ›´å°çš„ `hidden_dim`

2. **CUDAé”™è¯¯**
   - ç¡®ä¿CUDAç‰ˆæœ¬ä¸ŽPyTorchå…¼å®¹
   - æˆ–å¼ºåˆ¶ä½¿ç”¨CPU: `device = torch.device('cpu')`

3. **RDKitå¯¼å…¥å¤±è´¥**
   - ä½¿ç”¨condaå®‰è£…: `conda install -c conda-forge rdkit`
   - æˆ–è·³è¿‡RDKitç‰¹å¾: ä»£ç ä¼šè‡ªåŠ¨å¤„ç†

4. **æ•°æ®æ–‡ä»¶æ‰¾ä¸åˆ°**
   - æ£€æŸ¥æ•°æ®è·¯å¾„è®¾ç½®
   - ç¡®ä¿CSVæ–‡ä»¶æ ¼å¼æ­£ç¡®

### æ€§èƒ½ä¼˜åŒ–

1. **åŠ å¿«è®­ç»ƒé€Ÿåº¦**
   - ä½¿ç”¨GPUè®­ç»ƒ
   - å‡å°‘æ ·æœ¬æ•°é‡
   - é€‰æ‹©ç®€å•æ¨¡åž‹(GCNè€ŒéžTransformer)

2. **æå‡é¢„æµ‹ç²¾åº¦**
   - å¢žåŠ è®­ç»ƒepochæ•°
   - ä½¿ç”¨é«˜çº§ç‰¹å¾å·¥ç¨‹
   - å°è¯•é›†æˆæ–¹æ³•

3. **å‡å°‘å†…å­˜ä½¿ç”¨**
   - å‡å°batch size
   - ä½¿ç”¨æ›´å°çš„hiddenç»´åº¦
   - åˆ†æ‰¹å¤„ç†æ•°æ®

---

**Happy Learning! ðŸŽ‰**

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œæ¬¢è¿Žæå‡ºissueæˆ–è´¡çŒ®ä»£ç !